id: com.valvesoftware.Steam.CompatibilityTool.steam-dos
runtime: com.valvesoftware.Steam
sdk: org.freedesktop.Sdk//19.08beta
build-extension: true
build-options:
  prefix: /app/compatibilitytools.d/steam-dos
  prepend-path: /app/compatibilitytools.d/steam-dos/bin
  prepend-pkg-config-path: /app/compatibilitytools.d/steam-dos/lib/pkgconfig
  env:
    ACLOCAL_PATH: /app/compatibilitytools.d/steam-dos/share/aclocal
    CPATH: :/app/compatibilitytools.d/steam-dos/include
cleanup:
  - "*.a"
  - "*.la"
  - /include
  - /lib/pkgconfig
  - /share/aclocal
  - /share/man
modules:

  - name: dosbox
    sources:
      - type: archive
        url: "https://downloads.sourceforge.net/project/dosbox/dosbox/0.74-2/dosbox-0.74-2.tar.gz"
        sha256: 7077303595bedd7cd0bb94227fa9a6b5609e7c90a3e6523af11bc4afcb0a57cf
    modules:

      - shared-modules/SDL/SDL-1.2.15.json
      
      - shared-modules/SDL/SDL_net-1.2.8.json

      - name: SDL_sound
        sources:
          - type: archive
            url: "https://icculus.org/SDL_sound/downloads/SDL_sound-1.0.3.tar.gz"
            sha256: 3999fd0bbb485289a52be14b2f68b571cb84e380cc43387eadf778f64c79e6df

      - shared-modules/glu/glu-9.0.0.json

  - name: libXinerama
    sources:
      - type: archive
        url: "https://www.x.org/releases/individual/lib/libXinerama-1.1.4.tar.gz"
        sha256: 64de45e18cc76b8e703cb09b3c9d28bd16e3d05d5cd99f2d630de2d62c3acc18

  - name: steam-dos
    #TODO enable linting, requires shellcheck and pylint
    buildsystem: simple
    build-commands:
      - make install install_dir=${FLATPAK_DEST}
    sources:
      - type: git
        url: "https://github.com/dreamer/steam-dos.git"
        tag: v0.4.2
